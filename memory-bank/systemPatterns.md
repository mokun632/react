# System Patterns: React のアーキテクチャと設計

## 1. 主要アーキテクチャ

*   **Fiber アーキテクチャ:** React 16 で導入されたコアアルゴリズムの再実装。インクリメンタルレンダリング、中断・再開可能な更新処理などを可能にする。学習の中心的な対象。
*   **Reconciliation:** 仮想 DOM (Fiber ツリー) と実際のターゲット環境 (DOM など) との差分を計算し、効率的に更新を適用するプロセス。Render フェーズと Commit フェーズに分かれる。

## 2. 発見・学習中のパターン（随時更新）

*   **目標:** コードリーディングを通じて、React 内部で使われている具体的な設計パターン（例: State パターン、Strategy パターンなど）や、パッケージ間の連携方法を特定し、ここに記録していく。
*   **Render/Commit フェーズ分離:** 更新処理を計算フェーズ (Render) と副作用適用フェーズ (Commit) に明確に分けることで、中断可能なレンダリングやエラーハンドリングを実現している。
*   **Work-in-progress ツリー:** 更新中の状態を表す `alternate` Fiber ツリーを構築し、完了後に Current ツリーと入れ替えることで、不完全な状態がユーザーに見えないようにしている。
*   **Suspense と Offscreen の連携:** `Suspense` コンポーネントは、内部的に `Offscreen` コンポーネントを使用して子要素をラップし、その `mode` プロパティ (`'visible'` または `'hidden'`) を切り替えることで、コンテンツの表示・非表示を制御している。これにより、サスペンド時のフォールバック表示や、非表示状態でのレンダリング（プリレンダリング）を実現している。
*   **`.clinerules` による学習ガイドライン:** Reactの巨大なコードベースを効率的に学習するため、AIエージェント(Cline)との対話や分析の進め方を定義したルールセット (`.clinerules/`) を導入。これにより、特定の概念やパッケージに対する学習アプローチを体系化し、再現性のある学習プロセスを目指す。

## 3. 主要な技術的決定（随時更新）

*   (コード分析を通じて特定していく)
